(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{141:function(e,t,a){e.exports=a.p+"static/media/bookCover.9c00db32.jpg"},430:function(e,t,a){e.exports=a(817)},435:function(e,t,a){},658:function(e,t){},660:function(e,t){},692:function(e,t){},693:function(e,t){},817:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(98),l=a.n(c),o=(a(435),a(8)),i=a(9),s=a(11),u=a(10),m=a(12),h=a(29),p=a(99),d="/home",E="/story/list",g="/story/view/:story_id",f="/story/chapter/view/:story_id/:chapter_name",y="/story/apply",b="/story/accept",C="/story/deny",v="/story/update",k="/story/chapter/create",O="/story/update/chapter",j="/story/chapter/post",S="/story/update/chapter/post",w="/character/view/:character_id",I="/character/create",_="/character/update",R="http://localhost:3001",x=r.a.createContext(null),A=a(15),D=a.n(A),L=a(825),P=r.a.createContext(null),H=function(e){return function(t){return r.a.createElement(P.Consumer,null,function(a){return r.a.createElement(e,Object.assign({},t,{firebase:a}))})}},T=P,B=a(255),U=a.n(B),M=(a(526),{apiKey:"AIzaSyB862RXqfyPL9nkkIDwsQHdmxkNdxyki38",authDomain:"roleplay-e19d6.firebaseapp.com",databaseURL:"https://roleplay-e19d6.firebaseio.com",projectId:"roleplay-e19d6",storageBucket:"roleplay-e19d6.appspot.com",messagingSenderId:"406428153043"}),N=function e(){var t=this;Object(o.a)(this,e),this.doCreateUserWithEmailAndPassword=function(e,a){return t.auth.createUserWithEmailAndPassword(e,a)},this.doSignInWithEmailAndPassword=function(e,a){return t.auth.signInWithEmailAndPassword(e,a)},this.doSignOut=function(){return t.auth.signOut()},this.doPasswordReset=function(e){return t.auth.sendPasswordResetEmail(e)},this.doPasswordUpdate=function(e){return t.auth.currentUser.updatePassword(e)},U.a.initializeApp(M),this.auth=U.a.auth()},F=function(e){var t=!1;return{promise:new Promise(function(a,n){e.then(function(e){return t?null:a(e)},function(e){return n(t?{isCanceled:!0}:e)})}),cancel:function(){t=!0}}},G=function(e){var t=function(t){function a(e){var t;return Object(o.a)(this,a),(t=Object(s.a)(this,Object(u.a)(a).call(this,e))).promises=[],t.state={userInfo:null,checkedAuth:!1},t}return Object(m.a)(a,t),Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.firebase.auth.onAuthStateChanged(function(t){t?e.props.firebase.auth.currentUser.getIdToken(!0).then(function(a){e.promises.splice(e.promises.length-1,0,F(D.a.post("".concat(R,"/user"),{token:a}).then(function(n){e.setState({userInfo:{authUser:t,user:n.data.data},checkedAuth:!0}),localStorage.setItem("token",a)}).catch(function(e){console.log(e)})))}).catch(function(e){console.log(e)}):(e.setState({userInfo:null,checkedAuth:!0}),localStorage.setItem("token",null))})}},{key:"componentWillUnmount",value:function(){this.promises.forEach(function(e){return e.cancel()})}},{key:"render",value:function(){return r.a.createElement(x.Provider,{value:this.state.userInfo},this.state.checkedAuth?r.a.createElement(e,this.props):r.a.createElement(L.a,{active:!0}))}}]),a}(r.a.Component);return H(t)},W=a(28),z=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(n){var c=function(c){function l(){var e,t;Object(o.a)(this,l);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=Object(s.a)(this,(e=Object(u.a)(l)).call.apply(e,[this].concat(n)))).promises=[],t}return Object(m.a)(l,c),Object(i.a)(l,[{key:"componentDidMount",value:function(){var n=this;this.props.firebase.auth.onAuthStateChanged(function(r){r?n.props.firebase.auth.currentUser.getIdToken(!0).then(function(a){n.promises.splice(n.promises.length-1,0,F(D.a.post("".concat(R,"/user"),{token:a}).then(function(a){var c={authUser:r,user:a.data.data};e(c)||t(n.props.history)}).catch(function(e){console.log(e)})))}).catch(function(e){console.log(e)}):a||t(n.props.history)})}},{key:"componentWillUnmount",value:function(){this.promises.forEach(function(e){return e.cancel()})}},{key:"render",value:function(){var t=this;return r.a.createElement(x.Consumer,null,function(a){return e(a)?r.a.createElement(n,Object.assign({},t.props,{userInfo:a})):null})}}]),l}(r.a.Component);return Object(W.a)(p.d,H)(c)}},q=function(e){var t=function(t){function a(){return Object(o.a)(this,a),Object(s.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(m.a)(a,t),Object(i.a)(a,[{key:"render",value:function(){var t=this;return r.a.createElement(x.Consumer,null,function(a){return r.a.createElement(e,Object.assign({},t.props,{userInfo:a}))})}}]),a}(r.a.Component);return Object(W.a)(p.d,H)(t)},J=a(836),Q=a(101),Y=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).setTarget=function(e){e.includes("home")&&a.setState({menuTarget:"home"}),e.includes("account")&&a.setState({menuTarget:"account"}),e.includes("story")&&a.setState({menuTarget:"story"}),e.includes("character")&&a.setState({menuTarget:"character"}),"/"===e&&a.setState({menuTarget:"landing"}),e.includes("signin")&&a.setState({menuTarget:"signin"})},a.state={menuTarget:"home"},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setTarget(this.props.location.pathname),this.backListener=this.props.history.listen(function(t){e.setTarget(t.pathname)})}},{key:"componentWillUnmount",value:function(){this.backListener()}},{key:"render",value:function(){var e=this.props,t=this.state,a=e.userInfo,n=e.history,c=e.firebase,l=t.menuTarget,o=[{activeLink:"home",route:d,title:"Home",icon:"home"},{activeLink:"account",route:"/account",title:"Account",icon:"user"},{activeLink:"story",route:E,title:"Stories",icon:"book"},{activeLink:"character",route:"/character/list",title:"Characters",icon:"user secret"}],i=[{activeLink:"landing",route:"/",title:"Home",icon:"home"},{activeLink:"story",route:E,title:"Stories",icon:"book"},{activeLink:"signin",route:"/signin",title:"Sign In",icon:"sign in alternate"}];return r.a.createElement(J.a,{inverted:!0,pointing:!0,secondary:!0},a?[o.map(function(e,t){return r.a.createElement(J.a.Item,{color:"blue",key:t,active:l===e.activeLink,onClick:function(){n.push(e.route)}},r.a.createElement(Q.a,{name:e.icon,size:"large",color:l===e.activeLink?"blue":null}),r.a.createElement("div",null,e.title))}),r.a.createElement(J.a.Item,{key:o.length,onClick:function(e){c.doSignOut(),n.push("/")}},r.a.createElement(Q.a,{name:"sign out alternate",size:"large"}),"Log Out"),r.a.createElement(J.a.Item,{key:o.length+1,onClick:function(e){window.open("https://github.com/FedoraGameDev/roleplay/issues/new","_blank").focus()}},r.a.createElement(Q.a,{name:"bug",size:"large"}),"Report a Bug")]:i.map(function(e,t){return r.a.createElement(J.a.Item,{color:"blue",key:t,active:l===e.activeLink,onClick:function(){n.push(e.route)}},r.a.createElement(Q.a,{name:e.icon,size:"large",color:l===e.activeLink?"blue":null}),r.a.createElement("div",null,e.title))}))}}]),t}(r.a.Component),K=Object(W.a)(q,p.d,H)(Y),V=a(837),X=a(838),$=a(834),Z=q(function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(V.a,null,r.a.createElement(X.a,{as:"h1"},r.a.createElement("center",null,"Welcome to the roleplay website!")),r.a.createElement($.a,{attached:"top"},r.a.createElement($.a.Header,null,r.a.createElement("center",{style:{color:"red"}},"Note: this site is in beta."))),this.props.userInfo?r.a.createElement($.a,{attached:!0},r.a.createElement($.a.Header,null,"I see you've logged in. Head over to the characters page to create a character. Or, if you would like to see the stories, go to that page.")):r.a.createElement($.a,{attached:!0},r.a.createElement($.a.Header,null,"Head over to the log in page and click 'Sign Up' to create a new account.")),r.a.createElement($.a,{attached:!0},r.a.createElement($.a.Header,null,"A few things to keep in mind"),r.a.createElement($.a.List,null,r.a.createElement($.a.Item,null,"This site is subject to change."),r.a.createElement($.a.Item,null,"The backend is not in its final state, so some stories may not survive. Only start stories for testing purposes for now."),r.a.createElement($.a.Item,null,"Log in to get the link for reporting bugs."),r.a.createElement($.a.Item,null,"You may add suggestions to the bug reporting page, as well."))),r.a.createElement($.a,{attached:!0},r.a.createElement($.a.Header,null,"The purpose of this site is to bring the community to a well-formatted site for roleplaying. It was built on React to have a modern, snappy front-end experience. I am a solo developer, however, so updates may take time. I will keep all user suggestions in mind while building more features into the site.")),r.a.createElement($.a,{attached:"bottom"},r.a.createElement($.a.Header,null,"Planned Features"),r.a.createElement($.a.List,null,r.a.createElement($.a.Item,null,"Mobile-friendly interface"),r.a.createElement($.a.Item,null,"Chapter locks"),r.a.createElement($.a.Item,null,"Story search bar"),r.a.createElement($.a.Item,null,"BB code support"),r.a.createElement($.a.Item,null,"Notifications"),r.a.createElement($.a.Item,null,"Some other stuff I can't think of right now."))))}}]),t}(r.a.Component)),ee=a(50),te=a(13),ae=a(830),ne=a(818),re={username:"",email:"",passwordOne:"",passwordTwo:"",error:null},ce=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onSubmit=function(e){var t=a.state,n=t.username,r=t.email,c=t.passwordOne;a.props.firebase.doCreateUserWithEmailAndPassword(r,c).then(function(e){a.setState(Object(te.a)({},re)),a.props.firebase.auth.currentUser.getIdToken(!0).then(function(e){D.a.post("".concat(R,"/user/create"),{token:e,username:n}).then(function(t){localStorage.setItem("token",e),a.props.history.push(d)}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}).catch(function(e){a.setState({error:e})}),e.preventDefault()},a.onChange=function(e){a.setState(Object(ee.a)({},e.target.name,e.target.value))},a.state=Object(te.a)({},re),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state,t=e.username,a=e.email,n=e.passwordOne,c=e.passwordTwo,l=e.error,o=n!==c||""===n||""===a||""===t;return r.a.createElement(V.a,{attached:"bottom"},r.a.createElement(ae.a,{onSubmit:this.onSubmit},r.a.createElement(ae.a.Group,null,r.a.createElement(ae.a.Input,{name:"username",value:t,onChange:this.onChange,type:"text",placeholder:"Username"}),r.a.createElement(ae.a.Input,{name:"email",value:a,onChange:this.onChange,type:"text",placeholder:"Email"})),r.a.createElement(ae.a.Group,null,r.a.createElement(ae.a.Input,{name:"passwordOne",value:n,onChange:this.onChange,type:"password",placeholder:"Password"}),r.a.createElement(ae.a.Input,{name:"passwordTwo",value:c,onChange:this.onChange,type:"password",placeholder:"Confirm Password"})),r.a.createElement(ne.a,{disabled:o,type:"submit",primary:!0},"Sign Up"),l&&r.a.createElement("p",null,l.message)))}}]),t}(n.Component),le=Object(W.a)(p.d,H)(ce),oe=function(){return r.a.createElement(V.a,null,r.a.createElement($.a,{attached:"top"},r.a.createElement($.a.Header,null,"Sign Up")),r.a.createElement(le,null))},ie={email:"",error:null},se=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onSubmit=function(e){var t=a.state.email;a.props.firebase.doPasswordReset(t).then(function(){a.setState(Object(te.a)({},ie))}).catch(function(e){a.setState({error:e})}),e.preventDefault()},a.onChange=function(e){a.setState(Object(ee.a)({},e.target.name,e.target.value))},a.state=Object(te.a)({},ie),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,a=e.error,n=""===t;return r.a.createElement(V.a,null,r.a.createElement(ae.a,{onSubmit:this.onSubmit},r.a.createElement(ae.a.Group,null,r.a.createElement(ae.a.Input,{name:"email",value:this.state.email,onChange:this.onChange,type:"text",placeholder:"Email"})),r.a.createElement(ne.a,{primary:!0,disabled:n,type:"submit"},"Reset Password"),a&&r.a.createElement("p",null)))}}]),t}(n.Component),ue=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Password Forget"),r.a.createElement(me,null))},me=H(se),he={email:"",password:"",error:null,query:{}},pe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onSubmit=function(e){var t=a.state,n=t.email,r=t.password;a.props.firebase.doSignInWithEmailAndPassword(n,r).then(function(){a.props.firebase.auth.currentUser.getIdToken(!0).then(function(e){localStorage.setItem("token",e);var t={};a.props.location.search&&a.props.location.search.split("?")[1].split("&").forEach(function(e){var a=e.split("=");t[a[0]]=a[1]});t&&t.forward?a.props.history.push(t.forward):a.props.history.push(d)}).catch(function(e){console.log(e)})}).catch(function(e){a.setState({error:e})}),e.preventDefault()},a.onChange=function(e){a.setState(Object(ee.a)({},e.target.name,e.target.value))},a.state=Object(te.a)({},he),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.email,n=t.password,c=(t.error,""===n||""===a);return r.a.createElement(ae.a,{onSubmit:this.onSubmit,className:"attached fluid segment"},r.a.createElement(ae.a.Group,null,r.a.createElement(ae.a.Input,{name:"email",value:a,onChange:this.onChange,type:"text",placeholder:"Email"}),r.a.createElement(ae.a.Input,{name:"password",value:n,onChange:this.onChange,type:"password",placeholder:"Password"})),r.a.createElement(ne.a,{primary:!0,disabled:c,type:"submit"},"Sign In"),r.a.createElement(ne.a,{secondary:!0,onClick:function(){return e.props.history.push("/pw-forget")}},"Forgot Password?"))}}]),t}(n.Component),de=Object(W.a)(p.d,H)(pe),Ee=function(){return r.a.createElement(V.a,null,r.a.createElement($.a,{attached:"top"},r.a.createElement($.a.Header,null,"Sign In")),r.a.createElement(de,null),r.a.createElement($.a,{attached:"bottom",warning:!0},r.a.createElement(Q.a,{name:"help"}),"Don't have an account? ",r.a.createElement(h.b,{to:"/signup"},"Sign Up")))},ge=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(V.a,null,r.a.createElement(X.a,{as:"h1"},r.a.createElement("center",null,"Welcome, ",this.props.userInfo.user.username,"!")),r.a.createElement($.a,{attached:"top"},r.a.createElement($.a.Header,null,r.a.createElement("center",{style:{color:"red"}},"Note: this site is in beta."))),r.a.createElement($.a,{attached:!0},r.a.createElement($.a.Header,null,"A few things to keep in mind"),r.a.createElement($.a.List,null,r.a.createElement($.a.Item,null,"This site is subject to change."),r.a.createElement($.a.Item,null,"The backend is not in its final state, so some stories may not survive. Only start stories for testing purposes for now."),r.a.createElement($.a.Item,null,"If you encounter any bugs, please report them ",r.a.createElement("a",{href:"https://github.com/FedoraGameDev/roleplay/issues/new",target:"_blank"},"Here")," (requires free Github account)"),r.a.createElement($.a.Item,null,"You may add suggestions to the bug reporting page, as well."))),r.a.createElement($.a,{attached:!0},r.a.createElement($.a.Header,null,"Feel free to poke around the site and try some things out. If you think of any additions that you would like to see, Add them to the bug tracker as a feature.")),r.a.createElement($.a,{attached:"bottom"},r.a.createElement($.a.Header,null,"Planned Features"),r.a.createElement($.a.List,null,r.a.createElement($.a.Item,null,"Mobile-friendly interface"),r.a.createElement($.a.Item,null,"Chapter locks"),r.a.createElement($.a.Item,null,"Story search bar"),r.a.createElement($.a.Item,null,"BB code support"),r.a.createElement($.a.Item,null,"Notifications"),r.a.createElement($.a.Item,null,"Some other stuff I can't think of right now."))))}}]),t}(r.a.Component),fe=z(function(e){return!!e},function(e){return e.push("/signin")})(ge),ye={passwordOne:"",passwordTwo:"",error:null},be=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onSubmit=function(e){var t=a.state.passwordOne;a.props.firebase.doPasswordUpdate(t).then(function(){a.setState(Object(te.a)({},ye))}).catch(function(e){a.setState({error:e})}),e.preventDefault()},a.onChange=function(e){a.setState(Object(ee.a)({},e.target.name,e.target.value))},a.state=Object(te.a)({},ye),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state,t=e.passwordOne,a=e.passwordTwo,n=e.error,c=t!==a||""===t;return r.a.createElement(V.a,null,r.a.createElement(ae.a,{onSubmit:this.onSubmit},r.a.createElement(ae.a.Group,null,r.a.createElement(ae.a.Input,{name:"passwordOne",value:t,onChange:this.onChange,type:"password",placeholder:"New Password"}),r.a.createElement(ae.a.Input,{name:"passwordTwo",value:a,onChange:this.onChange,type:"password",placeholder:"Verify Password"})),r.a.createElement(ne.a,{primary:!0,disabled:c,type:"submit"},"Update My Password"),n&&r.a.createElement("p",null,n.message)))}}]),t}(n.Component),Ce=H(be),ve=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return console.log(this.props.userInfo),r.a.createElement(V.a,null,r.a.createElement(X.a,{as:"h1"},this.props.userInfo.user.username),r.a.createElement(X.a,{as:"h3"},this.props.userInfo.authUser.email),r.a.createElement(me,null),r.a.createElement(Ce,null))}}]),t}(r.a.Component),ke=z(function(e){return!(!e||!e.authUser)},function(e){return e.push("".concat("/signin","?forward=account"))})(ve),Oe=function(e){function t(e){var a;return Object(o.a)(this,t),a=Object(s.a)(this,Object(u.a)(t).call(this,e)),console.log(a.props),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Admin"))}}]),t}(r.a.Component),je=z(function(e){return!!e&&!!e.user.roles&&e.user.roles.includes("Admin")},function(e){return e.push("".concat("/signin","?forward=admin"))})(Oe),Se=a(829),we=a(73),Ie=a(826),_e=a(832),Re=a(827),xe=a(828),Ae=a(144),De={title:"",description:"",closed_group:!1,genres:[],genresSelection:{},error:null},Le=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){a.setState(Object(ee.a)({},e.target.name,e.target.value))},a.onSubmit=function(e){e.preventDefault();for(var t=a.state,n=t.title,r=t.description,c=t.closed_group,l=t.genresSelection,o=t.genres,i=[],s=0;s<o.length;s++){!0===l[o[s].name]&&i.splice(o.length-1,0,o[s]._id)}D.a.post("".concat(R,"/story/create"),{token:localStorage.getItem("token"),story:{title:n,description:r,closed_group:c,genres:i}}).then(function(e){a.props.history.push(g.replace(":story_id",e.data.newStory._id))}).catch(function(e){a.setState({error:e})})},a.onGenreChange=function(e){var t=Object(te.a)({},a.state.genresSelection);t[e]=!t[e],a.setState({genresSelection:t})},a.state=Object(te.a)({},De),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;D.a.get("".concat(R).concat("/story/genre/list")).then(function(t){e.setState({genres:t.data.genres})}).catch(function(e){console.log(e)})}},{key:"genreList",value:function(e){var t=e.info,a=t.genres,n=t.onGenreChange,c=a.map(function(e,t){return r.a.createElement("div",{className:"genre-item",key:t},r.a.createElement(Ie.a,{name:e.name,label:e.name,onChange:function(t){n(e.name)}}))});return r.a.createElement("ul",null,c)}},{key:"render",value:function(){var e=this.state,t=e.title,a=e.description,n=e.error,c=e.genres,l=""===t||""===a;return r.a.createElement(Se.a,null,r.a.createElement(_e.a,{inverted:!0,attached:"top"},r.a.createElement(_e.a.Header,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.HeaderCell,{textAlign:"center"},r.a.createElement(X.a,{as:"h2",inverted:!0},"New Story"))))),r.a.createElement(ae.a,{onSubmit:this.onSubmit},r.a.createElement(_e.a,{attached:"bottom"},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement(Re.a,{fluid:!0,type:"text",onChange:this.onChange,name:"title",value:t,placeholder:"title"}))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement(xe.a,{onChange:this.onChange,name:"description",value:a,placeholder:"description"}))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,{textAlign:"center"},r.a.createElement(Ae.a,null,"Genres"),r.a.createElement(this.genreList,{info:{genres:c,onGenreChange:this.onGenreChange}}))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,{textAlign:"right"},r.a.createElement(Ie.a,{onChange:this.onChange,name:"closed_group",toggle:!0,label:"Require Character Approval"}))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,{textAlign:"right"},r.a.createElement(ne.a,{disabled:l,primary:!0,type:"submit"},"Create"))))),n&&r.a.createElement("p",null,n.message)))}}]),t}(n.Component),Pe=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).Click=function(e){a.props.history.push(e)},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(ne.a,{primary:!0,onClick:function(t){return e.Click("/story/create")}},"New Story")}}]),t}(n.Component),He=Object(p.d)(Pe),Te=Object(W.a)(p.d,z(function(e){return!!e},function(e){return e.push("".concat("/signin","?forward=story/create"))}))(Le),Be=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.story,t=new Date(e.date_created);return r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,{width:10},r.a.createElement(h.b,{to:g.replace(":story_id",e._id)},e.title)),r.a.createElement(_e.a.Cell,{width:1},r.a.createElement("center",null,"".concat(t.getMonth(),"/").concat(t.getDate(),"/").concat(t.getFullYear()))),r.a.createElement(_e.a.Cell,{width:1},r.a.createElement("center",null,e.replies)),r.a.createElement(_e.a.Cell,{width:2},r.a.createElement("center",null,e.author.username)))}}]),t}(n.Component),Ue=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).TableCards=function(e){var t=e.stories.map(function(e,t){return r.a.createElement(Be,{key:t,story:e})});return r.a.createElement("div",null,r.a.createElement(_e.a,{inverted:!0,attached:"top"},r.a.createElement(_e.a.Header,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.HeaderCell,{width:10},"Title"),r.a.createElement(_e.a.HeaderCell,{width:1},r.a.createElement("center",null,"Date Created")),r.a.createElement(_e.a.HeaderCell,{width:1},r.a.createElement("center",null,"Post Count")),r.a.createElement(_e.a.HeaderCell,{width:2},r.a.createElement("center",null,"Author"))))),r.a.createElement(_e.a,{attached:"bottom",striped:!0},r.a.createElement(_e.a.Body,null,t)))},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(this.TableCards,{stories:this.props.stories})}}]),t}(n.Component),Me={genres:[],genreChecks:[],stories:[],filteredStories:[]},Ne=(n.Component,a(831)),Fe=a(418),Ge=a(839),We=a(409),ze=a.n(We),qe=a(83),Je=a.n(qe),Qe=[{key:0,value:0,text:"January"},{key:1,value:1,text:"February"},{key:2,value:2,text:"March"},{key:3,value:3,text:"April"},{key:4,value:4,text:"May"},{key:5,value:5,text:"June"},{key:6,value:6,text:"July"},{key:7,value:7,text:"August"},{key:8,value:8,text:"September"},{key:9,value:9,text:"October"},{key:10,value:10,text:"November"},{key:11,value:11,text:"December"}],Ye={character:{name:"",basicinfo:{age:0,gender:"",birthmonth:0,birthday:1,relationships:"",backstory:""},appearance:{hair:"#000000",eyes:"#000000",description:"",image:""},personality:{traits:"",likes:"",dislikes:"",habits:"",quirks:""}},imageSrc:"",crop:{aspect:1,width:50,x:0,y:0},pixelCrop:{},hasSubmittedAtLeastOnce:!1},Ke=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){var t=a.state.character;t[e.target.name]=e.target.value,a.setState({character:t})},a.onChangeBasic=function(e){var t=a.state.character;t.basicinfo[e.target.name]=e.target.value,a.setState({character:t})},a.onChangeAppearance=function(e){var t=a.state.character;t.appearance[e.target.name]=e.target.value,a.setState({character:t})},a.onChangePersonality=function(e){var t=a.state.character;t.personality[e.target.name]=e.target.value,a.setState({character:t})},a.onChangeCrop=function(e,t){a.setState({crop:e,pixelCrop:t})},a.onSubmit=function(e){e.preventDefault(),a.setState({hasSubmittedAtLeastOnce:!0}),a.props.onSubmit(a.state,a.imageRef)},a.onSelectFile=function(e){if(e.target.files&&e.target.files.length>0){var t=new FileReader;t.addEventListener("load",function(){return a.setState({imageSrc:t.result})}),t.readAsDataURL(e.target.files[0])}},a.onImageLoaded=function(e,t){a.imageRef=e},a.MonthsDropdown=function(e){var t=e.info.myself,a=t.state.character,n=Qe.map(function(e,t){return r.a.createElement("option",{value:e.key,key:t},e.text)});return r.a.createElement("select",{name:"birthmonth",placeholder:"Month",value:a.basicinfo.birthmonth,onChange:t.onChangeBasic},n)},a.state=Object(te.a)({},Ye),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.character&&this.setState({character:this.props.character})}},{key:"render",value:function(){var e=this.state,t=e.character,a=e.hasSubmittedAtLeastOnce,n=this.props.actionName,c=""===t.name||null===t.age;return r.a.createElement(ae.a,{onSubmit:this.onSubmit},r.a.createElement(Ge.a,{columns:2,centered:!0,stackable:!0},r.a.createElement(Ge.a.Row,null,r.a.createElement(Ge.a.Column,null,r.a.createElement(Ge.a,{columns:2,stackable:!0},r.a.createElement(Ge.a.Row,{columns:1},r.a.createElement(Ge.a.Column,null,r.a.createElement("center",null,r.a.createElement(Ae.a,{size:"big"},"General Info")))),r.a.createElement(Ge.a.Row,null,r.a.createElement(Ge.a.Column,null,r.a.createElement(Re.a,{error:a&&""===t.name,fluid:!0,labelPosition:"right corner",label:{icon:"asterisk"},name:"name",value:t.name,onChange:this.onChange,placeholder:"Name"})),r.a.createElement(Ge.a.Column,null,r.a.createElement(Re.a,{fluid:!0,error:a&&null===t.age,type:"number",name:"age",value:t.basicinfo.age,onChange:this.onChangeBasic,placeholder:"Age"}))),r.a.createElement(Ge.a.Row,{columns:4},r.a.createElement(Ge.a.Column,{width:8},r.a.createElement(Re.a,{fluid:!0,name:"gender",value:t.basicinfo.gender,onChange:this.onChangeBasic,placeholder:"Gender"})),r.a.createElement(Ge.a.Column,null,r.a.createElement(this.MonthsDropdown,{info:{myself:this}})),r.a.createElement(Ge.a.Column,null,r.a.createElement(Re.a,{fluid:!0,type:"number",min:"1",max:"31",name:"birthday",value:t.basicinfo.birthday,onChange:this.onChangeBasic,placeholder:"Birthday"}))),r.a.createElement(Ge.a.Row,{columns:1},r.a.createElement(Ge.a.Column,null,r.a.createElement(xe.a,{name:"relationships",value:t.basicinfo.relationships,onChange:this.onChangeBasic,placeholder:"Relationships"}))),r.a.createElement(Ge.a.Row,{columns:1},r.a.createElement(Ge.a.Column,null,r.a.createElement(xe.a,{name:"backstory",value:t.basicinfo.backstory,onChange:this.onChangeBasic,placeholder:"Backstory"}))))),r.a.createElement(Ge.a.Column,null,r.a.createElement(Ge.a,{columns:1},r.a.createElement(Ge.a.Row,null,r.a.createElement(Ge.a.Column,null,r.a.createElement("center",null,r.a.createElement(Ae.a,{size:"big"},"Image")))),r.a.createElement(Ge.a.Row,null,r.a.createElement(Ge.a.Column,null,r.a.createElement(Re.a,{fluid:!0,type:"file",onChange:this.onSelectFile}),r.a.createElement(ze.a,{src:this.state.imageSrc,crop:this.state.crop,onChange:this.onChangeCrop,onImageLoaded:this.onImageLoaded,onComplete:this.onCropComplete})))))),r.a.createElement(Ge.a.Row,null,r.a.createElement(Ge.a.Column,null,r.a.createElement(Ge.a,{columns:2},r.a.createElement(Ge.a.Row,{columns:1},r.a.createElement(Ge.a.Column,null,r.a.createElement("center",null,r.a.createElement(Ae.a,{size:"big"},"Appearance Info")))),r.a.createElement(Ge.a.Row,null,r.a.createElement(Ge.a.Column,null,r.a.createElement("center",null,r.a.createElement("p",null,"Hair Color: ",t.appearance.hair),r.a.createElement("input",{type:"color",name:"hair",value:t.appearance.hair,onChange:this.onChangeAppearance,placeholder:"Hair"}))),r.a.createElement(Ge.a.Column,null,r.a.createElement("center",null,r.a.createElement("p",null,"Eye Color: ",t.appearance.eyes),r.a.createElement("input",{type:"color",name:"eyes",value:t.appearance.eyes,onChange:this.onChangeAppearance,placeholder:"Eyes"})))),r.a.createElement(Ge.a.Row,{columns:1},r.a.createElement(Ge.a.Column,null,r.a.createElement(xe.a,{name:"description",value:t.appearance.description,onChange:this.onChangeAppearance,placeholder:"Description"}))))),r.a.createElement(Ge.a.Column,null,r.a.createElement(Ge.a,{columns:1},r.a.createElement(Ge.a.Row,{columns:1},r.a.createElement(Ge.a.Column,null,r.a.createElement("center",null,r.a.createElement(Ae.a,{size:"big"},"Personality Info")))),r.a.createElement(Ge.a.Row,null,r.a.createElement(Ge.a.Column,null,r.a.createElement(xe.a,{name:"traits",value:t.personality.traits,onChange:this.onChangePersonality,placeholder:"Traits"}))),r.a.createElement(Ge.a.Row,null,r.a.createElement(Ge.a.Column,null,r.a.createElement(xe.a,{name:"likes",value:t.personality.likes,onChange:this.onChangePersonality,placeholder:"Likes"}))),r.a.createElement(Ge.a.Row,null,r.a.createElement(Ge.a.Column,null,r.a.createElement(xe.a,{name:"dislikes",value:t.personality.dislikes,onChange:this.onChangePersonality,placeholder:"Dislikes"}))),r.a.createElement(Ge.a.Row,null,r.a.createElement(Ge.a.Column,null,r.a.createElement(xe.a,{name:"habits",value:t.personality.habits,onChange:this.onChangePersonality,placeholder:"Habits"}))),r.a.createElement(Ge.a.Row,null,r.a.createElement(Ge.a.Column,null,r.a.createElement(xe.a,{name:"quirks",value:t.personality.quirks,onChange:this.onChangePersonality,placeholder:"Quirks"})))))),r.a.createElement(ne.a,{disabled:c,type:"submit",primary:!0},n)))}}]),t}(n.Component),Ve=Object(W.a)(z(function(e){return!!e},function(e){return e.push("/signin")}),p.d)(Ke),Xe={characters:[]},$e=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).promises=[],a.onSubmit=function(e,t){var n=e.character,r=e.pixelCrop,c=e.crop;if(t&&c.width&&c.height){var l=document.createElement("canvas");l.width=250,l.height=250,l.getContext("2d").drawImage(t,r.x,r.y,r.width,r.height,0,0,250,250),Je.a.config({cloud_name:"dbfb8rwim",api_key:"553962313356325",api_secret:"W2xWSe-HJ9F1lt81i3fKJDaG5I4"}),Je.a.uploader.upload(l.toDataURL(),{tags:"user_image"}).then(function(e){n.appearance.image=e.url,D.a.post("".concat(R).concat(I),{token:localStorage.token,character:n}).then(function(e){a.setState(Object(te.a)({},Xe)),a.props.history.push(w.replace(":character_id",e.data.character._id))}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}},a.state=Object(te.a)({},Xe),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.promises.splice(this.promises.length-1,0,F(D.a.post("".concat(R).concat("/character/list"),{token:localStorage.getItem("token")}).then(function(t){e.setState({characters:t.data.characters})}).catch(function(e){console.log(e)})))}},{key:"componentWillUnmount",value:function(){this.promises.forEach(function(e){return e.cancel()})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Se.a,null,r.a.createElement(Ne.a,{trigger:r.a.createElement("center",null,r.a.createElement(ne.a,{primary:!0},"Create Character")),dimmer:"blurring",closeOnDimmerClick:!1,closeIcon:!0},r.a.createElement(Ne.a.Header,null,"New Character"),r.a.createElement(Ne.a.Content,{scrolling:!0},r.a.createElement(Ve,{onSubmit:this.onSubmit,actionName:"Create Character"}))),this.state.characters?r.a.createElement(it,{characters:this.state.characters}):null))}}]),t}(n.Component),Ze=z(function(e){return!!e},function(e){return e.push("/signin")})($e),et=a(420),tt={character:{name:"",basicinfo:{age:"",gender:"",birthmonth:0,birthday:1,relationships:"",backstory:""},appearance:{hair:"#000000",eyes:"#000000",description:"",image:""},personality:{traits:"",likes:"",dislikes:"",habits:"",quirks:""}},hairColor:{},eyeColor:{},ready:!1},at=q(function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onSubmit=function(e,t){var n=e.character,r=e.pixelCrop,c=e.crop,l={_id:n._id};if(n.name!==a.initialCharacter.name&&(l.name=n.name),["age","gender","birthmonth","birthday","relationships","backstory"].forEach(function(e){n.basicinfo[e]!==a.initialCharacter.basicinfo[e]&&(null==l.basicinfo&&(l.basicinfo={}),l.basicinfo[e]=n.basicinfo[e])}),["hair","eyes","description","image"].forEach(function(e){n.appearance[e]!==a.initialCharacter.appearance[e]&&(null==l.appearance&&(l.appearance={}),l.appearance[e]=n.appearance[e])}),["traits","likes","dislikes","habits","quirks"].forEach(function(e){n.personality[e]!==a.initialCharacter.personality[e]&&(null==l.personality&&(l.personality={}),l.personality[e]=n.personality[e])}),t&&c.width&&c.height){var o=document.createElement("canvas");o.width=250,o.height=250,o.getContext("2d").drawImage(t,r.x,r.y,r.width,r.height,0,0,250,250),Je.a.config({cloud_name:"dbfb8rwim",api_key:"553962313356325",api_secret:"W2xWSe-HJ9F1lt81i3fKJDaG5I4"}),Je.a.uploader.upload(o.toDataURL(),{tags:"user_image"}).then(function(e){null==l.appearance&&(l.appearance={}),l.appearance.image=e.url,a.sendModifiedCharacter(l)}).catch(function(e){console.log(e)})}else a.sendModifiedCharacter(l)},a.sendModifiedCharacter=function(e){console.log(e),D.a.post("".concat(R).concat(_),{token:localStorage.token,character:e}).then(function(e){a.props.history.push(w.replace(":character_id",a.state.character._id))}).catch(function(e){console.log(e)})},a.state=Object(te.a)({},tt),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;D.a.post("".concat(R).concat(w.replace(":character_id",this.props.match.params.character_id)),{token:localStorage.token}).then(function(t){e.setState({character:t.data.character}),e.initialCharacter={_id:e.state.character._id,name:"".concat(e.state.character.name),basicinfo:Object(te.a)({},e.state.character.basicinfo),appearance:Object(te.a)({},e.state.character.appearance),personality:Object(te.a)({},e.state.character.personality)},D.a.get("https://www.thecolorapi.com/id?format=json&hex=".concat(e.state.character.appearance.eyes.replace("#",""))).then(function(t){e.setState({eyeColor:t.data}),D.a.get("https://www.thecolorapi.com/id?format=json&hex=".concat(e.state.character.appearance.hair.replace("#",""))).then(function(t){e.setState({hairColor:t.data,ready:!0})}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this.state,t=e.character,a=e.ready,n=e.eyeColor,c=e.hairColor,l=t.basicinfo;return r.a.createElement(Se.a,null,a?[r.a.createElement(_e.a,{key:1,inverted:!0,attached:"top"},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement("center",null,r.a.createElement(X.a,{as:"h1",inverted:!0,size:"huge"},t.name)))))),r.a.createElement(_e.a,{key:2,attached:"bottom"},r.a.createElement(_e.a.Body,null,this.props.userInfo&&"".concat(this.props.userInfo.user._id)==="".concat(t.user)?r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement(Ne.a,{key:0,trigger:r.a.createElement("center",null,r.a.createElement(ne.a,{primary:!0},"Modify Character")),dimmer:"blurring",closeOnDimmerClick:!1,closeIcon:!0},r.a.createElement(Ne.a.Header,null,"Modify ",t.name),r.a.createElement(Ne.a.Content,{scrolling:!0},r.a.createElement(Ve,{character:t,onSubmit:this.onSubmit,actionName:"Update Character"}))))):null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement(_e.a,{fixed:!0,basic:"very"},r.a.createElement(_e.a.Header,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.HeaderCell,{textAlign:"center"},"Age"),r.a.createElement(_e.a.HeaderCell,{textAlign:"center"},"Gender"),r.a.createElement(_e.a.HeaderCell,{textAlign:"center"},"Birthday"),r.a.createElement(_e.a.HeaderCell,{textAlign:"center"},"Eyes"),r.a.createElement(_e.a.HeaderCell,{textAlign:"center"},"Hair"))),r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,{textAlign:"center"},l.age),r.a.createElement(_e.a.Cell,{textAlign:"center"},l.gender),r.a.createElement(_e.a.Cell,{textAlign:"center"},Qe[l.birthmonth].text," ",l.birthday),r.a.createElement(_e.a.Cell,{textAlign:"center"},r.a.createElement("div",{className:"color-background",style:{backgroundColor:n.name.closest_named_hex,color:n.contrast.value}},n.name.value)),r.a.createElement(_e.a.Cell,{textAlign:"center"},r.a.createElement("div",{className:"color-background",style:{backgroundColor:c.name.closest_named_hex,color:c.contrast.value}},c.name.value))))),r.a.createElement("center",null,r.a.createElement(Ae.a,null,r.a.createElement(X.a,{as:"h2"},"Description"))),r.a.createElement(et.a,{src:t.appearance.image,floated:"left"}),r.a.createElement("pre",null,t.appearance.description))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement("center",null,r.a.createElement(Ae.a,null,r.a.createElement(X.a,{as:"h2"},"Traits"))),r.a.createElement("pre",null,t.personality.traits))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement("center",null,r.a.createElement(Ae.a,null,r.a.createElement(X.a,{as:"h2"},"Likes"))),r.a.createElement("pre",null,t.personality.likes))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement("center",null,r.a.createElement(Ae.a,null,r.a.createElement(X.a,{as:"h2"},"Dislikes"))),r.a.createElement("pre",null,t.personality.dislikes))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement("center",null,r.a.createElement(Ae.a,null,r.a.createElement(X.a,{as:"h2"},"Habits"))),r.a.createElement("pre",null,t.personality.habits))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement("center",null,r.a.createElement(Ae.a,null,r.a.createElement(X.a,{as:"h2"},"Quirks"))),r.a.createElement("pre",null,t.personality.quirks))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement("center",null,r.a.createElement(Ae.a,null,r.a.createElement(X.a,{as:"h2"},"Backstory"))),r.a.createElement("pre",null,t.basicinfo.backstory)))))]:r.a.createElement(L.a,{active:!0}))}}]),t}(n.Component)),nt=(a(816),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(Se.a,null,r.a.createElement(Ve,null))}}]),t}(n.Component)),rt=(n.Component,Object(W.a)(z(function(e){return!!e},function(e){return e.push("/signin")}),p.d)(nt)),ct=a(833),lt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(e){a.props.onClick?a.props.onClick(e):a.goToPage(w.replace(":character_id",e._id))},a.goToPage=function(e){a.props.history.push(e)},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.actionButtons,n=t.character;return r.a.createElement(ct.a,{link:!0,className:"character-card",onClick:function(){return e.onClick(n)}},r.a.createElement(et.a,{src:n.appearance.image}),r.a.createElement(ct.a.Content,null,r.a.createElement(ct.a.Header,null,n.name),a))}}]),t}(n.Component),ot=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.actionButtons,a=this.props.characters.map(function(a,n){return r.a.createElement(lt,{key:n,character:a,history:e.props.history,onClick:e.props.onClick,actionButtons:t})});return r.a.createElement(Se.a,{className:"character-grid"},r.a.createElement(ct.a.Group,{centered:!0},a))}}]),t}(n.Component),it=Object(p.d)(ot),st=Object(p.d)(lt),ut={story:{author:{},genres:[],chapters:[],characters:[]},characterList:null,selectedCharacter:0},mt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).getStory=function(){D.a.get("".concat(R).concat(g.replace(":story_id",a.props.match.params.story_id))).then(function(e){a.setState({story:e.data.story})}).catch(function(e){console.log(e)})},a.listCharacterOptions=function(e){var t=e.info.myself,a=t.state,n=a.characterList.map(function(e,t){return r.a.createElement("option",{key:t,value:e._id},e.name)});return r.a.createElement("select",{placeholder:"Characters",value:a.selectedCharacter,onChange:t.onChooseCharacterChange},n)},a.onLinkClick=function(e){a.props.history.push(e)},a.onChooseCharacterChange=function(e){a.setState({selectedCharacter:e.target.value})},a.onApplyCharacter=function(e){e.preventDefault(),D.a.post("".concat(R).concat(y),{token:localStorage.getItem("token"),character_id:a.state.selectedCharacter,story_id:a.state.story._id}).then(function(e){var t=e.data,n=t.message,r=t.status;alert(n),"added"===r&&(a.setState({story:ut.story}),a.getStory())}).catch(function(e){console.log(e)})},a.state=Object(te.a)({},ut),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getStory(),this.props.userInfo&&D.a.post("".concat(R).concat("/character/list"),{token:localStorage.getItem("token")}).then(function(t){0===t.data.characters.length?e.setState({characterList:null}):e.setState({characterList:t.data.characters,selectedCharacter:t.data.characters[0]._id})}).catch(function(e){console.log(e)})}},{key:"listGenres",value:function(e){var t=e.genres.map(function(e,t){return r.a.createElement(_e.a.Cell,{key:t,value:t},r.a.createElement("center",null,e.name))});return r.a.createElement(_e.a.Row,null,t)}},{key:"listChapters",value:function(e){var t=e.info,a=t.myself,n=t.onLinkClick,c=a.props,l=a.state,o=l.story,i=l.characterList,s=o.chapters,u=o.characters,m=c.userInfo,p=c.match.params.story_id,d=!!m&&m.user.username===o.author.username,E=s.map(function(e,t){return r.a.createElement(_e.a.Row,{key:t},r.a.createElement(_e.a.Cell,null,r.a.createElement(h.b,{to:f.replace(":story_id",p).replace(":chapter_name",t)},e.title)),r.a.createElement(_e.a.Cell,null,e.description))});return r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,d?r.a.createElement(ne.a,{primary:!0,onClick:function(e){n(k.replace(":story_id",p))}},"Create Chapter"):null,m?r.a.createElement(Ne.a,{trigger:r.a.createElement(ne.a,{secondary:!0},"Add Character")},r.a.createElement(Ne.a.Header,null,"Choose your character"),r.a.createElement(Ne.a.Content,null,r.a.createElement(Fe.a,null,i?r.a.createElement(ae.a,{onSubmit:a.onApplyCharacter},r.a.createElement(a.listCharacterOptions,{info:{myself:a}}),r.a.createElement(ne.a,{primary:!0,type:"submit"},o.closed_group?"Apply":"Join")):r.a.createElement("div",null,"Loading...")))):null,r.a.createElement(Ne.a,{trigger:r.a.createElement(ne.a,{secondary:!0},"Roster")},r.a.createElement(Ne.a.Header,null,"Character Roster"),r.a.createElement(Ne.a.Content,null,r.a.createElement(Fe.a,null,u?r.a.createElement(it,{characters:u}):r.a.createElement("div",null,"Loading...")))))),E)}},{key:"render",value:function(){return r.a.createElement(Se.a,null,r.a.createElement(_e.a,{inverted:!0,attached:"top"},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.HeaderCell,null,r.a.createElement("center",null,r.a.createElement(X.a,{as:"h1",inverted:!0},this.state.story.title)))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.HeaderCell,null,r.a.createElement("center",null,r.a.createElement(X.a,{as:"h4",inverted:!0},"by ",this.state.story.author.username)))))),r.a.createElement(_e.a,{attached:!0},r.a.createElement(_e.a.Body,null,r.a.createElement(this.listGenres,{genres:this.state.story.genres}),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement("center",null,this.state.story.description))))),r.a.createElement(_e.a,{attached:!0},r.a.createElement(this.listChapters,{info:{myself:this,props:this.props,state:this.state,onLinkClick:this.onLinkClick}})))}}]),t}(n.Component),ht=(Object(W.a)(q,p.d)(mt),{story:{_id:"",author:{},genres:[],chapters:[]},chapter:{title:"",description:""}}),pt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){var t=a.state.chapter;t[e.target.name]=e.target.value,a.setState({chapter:t})},a.onSubmit=function(e){e.preventDefault();var t=a.state,n=t.story,r=t.chapter;D.a.post("".concat(R,"/story/add_chapter/").concat(a.props.match.params.story_id),{token:localStorage.getItem("token"),story:n,chapter:r}).then(function(e){a.props.history.push(g.replace(":story_id",n._id))}).catch(function(e){console.log(e)})},a.state=Object(te.a)({},ht),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;D.a.get("".concat(R).concat(g.replace(":story_id",this.props.match.params.story_id))).then(function(t){e.setState({story:t.data.story,chapter:{title:"Chapter ".concat(t.data.story.chapters.length+1)}}),e.props.userInfo.user.username!==e.state.story.author.username&&e.props.history.push("".concat(g.replace(":story_id",e.props.match.params.story_id)))}).catch(function(e){console.log(e)})}},{key:"render",value:function(){return r.a.createElement(Se.a,null,r.a.createElement(_e.a,{attached:"top",inverted:!0},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement("center",null,r.a.createElement(X.a,{as:"h1",inverted:!0},this.state.chapter.title)))))),r.a.createElement(_e.a,{attached:!0},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,this.state.story.author?r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement(Re.a,{fluid:!0,onChange:this.onChange,name:"description",value:this.state.chapter.description,placeholder:"description"}),r.a.createElement("center",null,r.a.createElement(ne.a,{type:"submit",primary:!0},"Create Chapter"))):r.a.createElement(L.a,{active:!0}))))))}}]),t}(n.Component),dt=Object(W.a)(p.d,q)(pt),Et={postData:"",character:0},gt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onSubmit=function(e){},a.onChange=function(e){a.setState({postData:e.target.value})},a.state=Object(te.a)({},Et),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(ae.a,{onSubmit:this.onSubmit},r.a.createElement("select",{placeholder:"Characters",value:this.state.character},this.props.characters.map(function(e,t){return r.a.createElement("option",{key:t,value:e._id},e.name)})),r.a.createElement(xe.a,{placeholder:"paragraph",name:"postData",onChange:this.onChange}),r.a.createElement(ne.a,{primary:!0,type:"submit"},"Submit"))}}]),t}(n.Component),ft=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).clickLink=function(e){a.props.history.push(e)},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.info.story_id;return r.a.createElement(ne.a,{primary:!0,onClick:function(a){e.clickLink("/story/post/:story_id".replace(":story_id",t))}},"Write Paragraph")}}]),t}(n.Component),yt=(Object(p.d)(ft),gt),bt={chapter:null,showReplyForm:!1},Ct=(q(function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).createParagraphClick=function(e){a.setState({showReplyForm:!a.state.showReplyForm})},a.state=Object(te.a)({},bt),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params,a=t.story_id,n=t.chapter_name;D.a.get("".concat(R).concat(f.replace(":story_id",a).replace(":chapter_name",n))).then(function(t){e.setState({chapter:t.data.chapter})}).catch(function(e){console.log(e)})}},{key:"listReplies",value:function(e){var t=e.info.myself,a=t.state,n=t.props,c=a.chapter,l=a.showReplyForm,o=n.userInfo,i=function(e){return r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement(et.a,{floated:"left",src:e.author.appearance.image}),r.a.createElement("pre",null,e.description))))},s=c.posts.map(function(e,t){return r.a.createElement(_e.a.Row,{key:t},r.a.createElement(_e.a.Cell,null,r.a.createElement(_e.a,{attached:"top",inverted:!0},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement("center",null,r.a.createElement(X.a,{as:"h2",inverted:!0},e.author.name)))))),t===c.posts.length-1?r.a.createElement(_e.a,{attached:"bottom"},i(e)):r.a.createElement(_e.a,{attached:!0},i(e))))});return r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,o?r.a.createElement(ne.a,{primary:!l,secondary:l,onClick:t.createParagraphClick},l?"Cancel":"Create Paragraph"):null,l?r.a.createElement(yt,null):null)),s)}},{key:"render",value:function(){var e=this.state;return r.a.createElement(Se.a,null,e.chapter?r.a.createElement(_e.a,{className:"basic-table"},r.a.createElement(this.listReplies,{info:{myself:this}})):r.a.createElement(L.a,{active:!0}))}}]),t}(n.Component)),a(419)),vt=a.n(Ct),kt=a(141),Ot=a.n(kt),jt={backgroundColor:"#FFFFFF55",fontColor:"black"},St=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).promises=[],a.goToPage=function(e){a.props.history.push(e)},a.state=Object(te.a)({},jt),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.story&&this.promises.splice(this.promises.length-1,0,F(D.a.get("https://www.thecolorapi.com/id?format=json&hex=".concat(this.props.story.color.replace("#",""))).then(function(t){e.setState({backgroundColor:"".concat(t.data.name.closest_named_hex,"55"),fontColor:t.data.contrast.value})}).catch(function(e){console.log(e)})))}},{key:"componentWillUnmount",value:function(){this.promises.forEach(function(e){return e.cancel()})}},{key:"render",value:function(){var e=this,t=this.props,a=t.story,n=t.loader,c=a?new Date(a.date_created):null,l=this.state,o=l.backgroundColor,i=l.fontColor,s=c?"".concat(c.getMonth(),"/").concat(c.getDate(),"/").concat(c.getFullYear()):null;return r.a.createElement(ct.a,{link:!0,className:"book-card",style:{width:"150px",height:"175px",backgroundImage:"url(".concat(Ot.a,")"),color:i,backgroundSize:"150px auto"},onClick:function(){n||e.goToPage(g.replace(":story_id",a._id))}},r.a.createElement("div",{className:"content",style:{backgroundColor:o,color:i,display:"flex",alignItems:"center"}},n?r.a.createElement(L.a,{active:!0}):r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(X.a,{style:{color:i}},a.title),r.a.createElement("i",null,a.author.username)," ",r.a.createElement("br",null),s)))}}]),t}(n.Component),wt=Object(p.d)(St),It=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.genres,a=e.onChange,n=e.selections;return r.a.createElement(ct.a.Group,{centered:!0},t.map(function(e,t){return r.a.createElement(ct.a,{key:t,style:{width:"auto",padding:"5px 10px"}},r.a.createElement(Ie.a,{toggle:!0,name:e.name,label:e.name,checked:n&&n[e.name],onChange:function(t){a(e.name)}}))}))}}]),t}(n.Component),_t={story:{author:{},chapters:[],characters:[],description:"",genres:[],subscribers:[],applicantcharacters:[],color:"#000000",title:""},genresSelection:{}},Rt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){var t=Object(te.a)({},a.state.story);t[e.target.name]=e.target.value,a.setState({story:t})},a.onCheckboxChange=function(e,t){var n=t.checked,r=Object(te.a)({},a.state.story);r.closed_group=n,a.setState({story:r})},a.onGenreChange=function(e){var t=Object(te.a)({},a.state.genresSelection);t[e]=!t[e],a.setState({genresSelection:t})},a.onSubmit=function(e){e.preventDefault();for(var t=Object(te.a)({},a.state.story),n=Object(te.a)({},a.state.genresSelection),r=a.props,c=r.genres,l=r.onStorySubmit,o=[],i=0;i<c.length;i++)n[c[i].name]&&o.splice(o.length,0,c[i]._id);t.genres=o,l(t)},a.state=Object(te.a)({},_t),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){if(this.props.story){var e={},t=this.props.story.genres.map(function(e){return e.name});this.props.genres.forEach(function(a){-1!==t.indexOf(a.name)?e[a.name]=!0:e[a.name]=!1}),this.setState({story:this.props.story,genresSelection:e})}else{var a={};this.props.genres.forEach(function(e){a[e.name]=!1}),this.setState({genresSelection:a})}}},{key:"render",value:function(){var e=this.state,t=e.story,a=e.genresSelection,n=t.title,c=t.description,l=t.color,o=t.closed_group,i=this.props.genres;return r.a.createElement(ae.a,{onSubmit:this.onSubmit},r.a.createElement(_e.a,{attached:"top"},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,{collapsing:!0},r.a.createElement(Re.a,{fluid:!0,type:"color",onChange:this.onChange,name:"color",value:l})),r.a.createElement(_e.a.Cell,null,r.a.createElement(Re.a,{fluid:!0,type:"text",onChange:this.onChange,name:"title",value:n,placeholder:"title"}))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,{width:2},r.a.createElement(ct.a,{className:"book-card",style:{width:"150px",height:"175px",backgroundImage:"url(".concat(Ot.a,")"),backgroundSize:"150px auto"}},r.a.createElement("div",{className:"Content",style:{backgroundColor:"".concat(l,"55"),height:"100%"}}))),r.a.createElement(_e.a.Cell,null,r.a.createElement(xe.a,{onChange:this.onChange,name:"description",value:c,placeholder:"description"}))))),r.a.createElement(_e.a,{attached:"bottom"},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,{textAlign:"center"},r.a.createElement(It,{genres:i,selections:a,onChange:this.onGenreChange}))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,{textAlign:"right"},r.a.createElement(Ie.a,{onChange:this.onCheckboxChange,name:"closed_group",checked:o,toggle:!0,label:"Require Character Approval"}))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,{textAlign:"right"},r.a.createElement(ne.a,{primary:!0,type:"submit"},this.props.actionText))))))}}]),t}(n.Component),xt={stories:null,loadedQty:0,genreChecks:{},filteredStories:[],hasMore:!0},At=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).fetchStoriesPromise=null,a.keepLoadingDataRoutine=null,a.onStoryCreateSubmit=function(e){D.a.post("".concat(R,"/story/create"),{token:localStorage.getItem("token"),story:e}).then(function(e){a.props.history.push(g.replace(":story_id",e.data.newStory._id))}).catch(function(e){a.setState({error:e})})},a.onGenreChange=function(e){a.timeout&&clearTimeout(a.timeout);var t=Object(te.a)({},a.state.genreChecks);t[e]=!t[e],a.setState({genreChecks:t}),a.timeout=setTimeout(a.filterStories,500)},a.filterStories=function(){var e=a.state,t=e.stories,n=e.genreChecks,r=a.props.genres,c=Object(we.a)(t);if(a.checkFilters())for(var l=0;l<r.length;l++){if(!0===n[r[l].name])for(var o=0;o<c.length;)-1!==c[o].genres.indexOf(r[l]._id)?o++:c.splice(o,1)}a.setState({filteredStories:c})},a.checkFilters=function(){for(var e=0;e<a.props.genres.length;e++){var t=a.state.genreChecks[a.props.genres[e].name];if(void 0!==t&&!0===t)return!0}return!1},a.fetchData=function(){a.fetchStoriesPromise||a.PullDataPart(a.state.loadedQty,10)},a.PullDataPart=function(e,t){a.fetchStoriesPromise=F(D.a.get("".concat(R+E,"/").concat(e,"/").concat(t)).then(function(e){var t=e.data.stories;a.state.stories&&(t=[].concat(Object(we.a)(a.state.stories),Object(we.a)(e.data.stories))),a.setState({stories:Object(we.a)(t),filteredStories:Object(we.a)(e.data.stories),loadedQty:t.length,hasMore:e.data.hasMore}),a.fetchStoriesPromise=null,a.filterStories()}).catch(function(e){console.log(e)}))},a.state=Object(te.a)({},xt),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.PullDataPart(0,30)}},{key:"componentWillUnmount",value:function(){this.fetchStoriesPromise&&this.fetchStoriesPromise.cancel()}},{key:"render",value:function(){var e=this.props.genres,t=this.state,a=t.stories,n=t.hasMore,c=t.filteredStories;return r.a.createElement(Se.a,null,this.props.userInfo?r.a.createElement($.a,{attached:"top"},r.a.createElement(Ne.a,{trigger:r.a.createElement("center",null,r.a.createElement(ne.a,{primary:!0},"New Story")),dimmer:"blurring",closeOnDimmerClick:!1,closeIcon:!0},r.a.createElement(Ne.a.Header,null,"New Story"),r.a.createElement(Ne.a.Content,null,r.a.createElement(Rt,{genres:e,onStorySubmit:this.onStoryCreateSubmit,actionText:"Create"})))):null,e?r.a.createElement($.a,{attached:!0},r.a.createElement(It,{genres:e,onChange:this.onGenreChange})):null,a?r.a.createElement($.a,{attached:"bottom"},r.a.createElement(vt.a,{className:"ui centered cards",style:{marginTop:"20px"},dataLength:a.length,next:this.fetchData,hasMore:n,hasChildren:!0},c.map(function(e,t){return r.a.createElement(wt,{key:t,story:e})}),n?r.a.createElement(wt,{loader:!0}):null)):r.a.createElement(ct.a.Group,{centered:!0},r.a.createElement(wt,{loader:!0})))}}]),t}(n.Component),Dt=Object(W.a)(p.d,q)(At),Lt={chapter:{description:"",title:""}},Pt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){var t=Object(te.a)({},a.state.chapter);t.description=e.target.value,a.setState({chapter:t})},a.onSubmit=function(e){e.preventDefault(),a.props.onSubmit(a.state.chapter)},a.state=Object(te.a)({},Lt),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.chapter&&this.setState({chapter:this.props.chapter})}},{key:"render",value:function(){var e=this.state.chapter;return r.a.createElement(ae.a,{onSubmit:this.onSubmit},r.a.createElement(xe.a,{placeholder:"Description...",value:e.description,onChange:this.onChange}),r.a.createElement(ne.a,{type:"submit",primary:!0},"Create Chapter"))}}]),t}(n.Component),Ht={story:{_id:"",author:{},chapters:[],characters:[],description:"",genres:[],subscribers:[],applicantcharacters:[],title:""},characterList:null,loadedStory:!1,loadedCharacters:!1},Tt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).promises=[],a.goToLink=function(e){a.props.history.push(e)},a.onCharacterApplyClick=function(e){D.a.post("".concat(R).concat(y),{token:localStorage.token,character_id:e._id,story_id:a.props.match.params.story_id}).then(function(t){switch(t.data.status){case"applied":console.log(t.data.message),a.addToApplicants(e);break;case"added":console.log(t.data.message),a.addToRosterFree(e);break;case"error":console.log(t.data.message);break;default:console.log('Server responded with an unknown status "'.concat(t.data.status,'"'))}}).catch(function(e){console.log(e)})},a.onAccept=function(e,t){e.stopPropagation(),D.a.post("".concat(R).concat(b),{token:localStorage.getItem("token"),character_id:t._id,story_id:a.state.story._id}).then(function(e){a.addToRoster(t),a.removeFromApplicants(t)}).catch(function(e){console.log(e)})},a.onDeny=function(e,t){e.stopPropagation(),D.a.post("".concat(R).concat(C),{token:localStorage.getItem("token"),character_id:t._id,story_id:a.state.story._id}).then(function(e){a.removeFromApplicants(t)}).catch(function(e){console.log(e)})},a.addToApplicants=function(e){var t=Object(te.a)({},a.state.story),n=t.applicantcharacters?t.applicantcharacters:[];n.splice(n.length,0,e),t.applicantcharacters=n,a.setState({story:t})},a.addToRosterFree=function(e){var t=Object(te.a)({},a.state.story),n=t.characters?t.characters:[];n.splice(n.length,0,e),t.characters=n,a.setState({story:t})},a.addToRoster=function(e){var t=Object(te.a)({},a.state.story),n=t.characters?t.characters:[];n.splice(n.length,0,e),t.characters=n,a.setState({story:t})},a.removeFromApplicants=function(e){for(var t=Object(te.a)({},a.state.story),n=t.applicantcharacters,r=-1,c=0;c<n.length;c++)if(n[c]._id===e._id){r=c;break}n.splice(r,1),t.applicantcharacters=n,a.setState({story:t})},a.submitChapter=function(e){D.a.post("".concat(R).concat(k),{token:localStorage.getItem("token"),chapter:e,story:a.state.story}).then(function(e){var t=a.props.history.location.pathname;a.props.history.push("/"),a.props.history.push(t)}).catch(function(e){console.log(e)})},a.updateChapter=function(e){D.a.post("".concat(R).concat(O),{token:localStorage.getItem("token"),chapter:e,story:a.state.story}).then(function(e){var t=a.props.history.location.pathname;a.props.history.push("/"),a.props.history.push(t)}).catch(function(e){console.log(e)})},a.onChapterClick=function(e,t){a.goToLink(f.replace(":story_id",e).replace(":chapter_name",t))},a.onUpdateStory=function(e){var t={_id:e._id,title:e.title,description:e.description,genres:e.genres,closed_group:e.closed_group,color:e.color};D.a.post("".concat(R).concat(v),{token:localStorage.getItem("token"),story:t}).then(function(e){var t=a.props.history.location.pathname;a.props.history.push("/"),a.props.history.push(t)}).catch(function(e){a.setState({error:e})})},a.state=Object(te.a)({},Ht),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.promises.splice(this.promises.length-1,0,F(D.a.get("".concat(R).concat(g.replace(":story_id",this.props.match.params.story_id))).then(function(t){e.setState({story:t.data.story,loadedStory:!0})}).catch(function(e){console.log(e)}))),this.props.userInfo&&this.promises.splice(this.promises.length-1,0,F(D.a.post("".concat(R).concat("/character/list"),{token:localStorage.getItem("token")}).then(function(t){0===t.data.characters.length?e.setState({characterList:null,loadedCharacters:!0}):e.setState({characterList:t.data.characters,loadedCharacters:!0})}).catch(function(e){console.log(e)})))}},{key:"componentWillUnmount",value:function(){this.promises.forEach(function(e){e.cancel()})}},{key:"render",value:function(){var e=this,t=this.state,a=t.story,n=t.characterList,c=t.loadedStory,l=t.loadedCharacters,o=this.props.userInfo,i=!!o&&o.user.username===a.author.username;return r.a.createElement("div",null,c?r.a.createElement("div",null,r.a.createElement(_e.a,{inverted:!0,attached:"top"},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.HeaderCell,null,r.a.createElement("center",null,r.a.createElement(X.a,{as:"h1",inverted:!0},a.title)))),r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.HeaderCell,null,r.a.createElement("center",null,r.a.createElement(X.a,{as:"h4",inverted:!0},"by ",a.author.username)))))),r.a.createElement(_e.a,{attached:!0,fixed:!0},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,{textAlign:"center"},a.genres.map(function(e,t){return r.a.createElement(_e.a.Cell,{key:t},e.name)})))),r.a.createElement(_e.a,{attached:!0},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement("center",null,a.description))))),r.a.createElement(_e.a,{attached:!0},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,i?r.a.createElement("span",null,r.a.createElement(Ne.a,{trigger:r.a.createElement(ne.a,{primary:!0},"Edit Story"),dimmer:"blurring",closeOnDimmerClick:!1,closeIcon:!0},r.a.createElement(Ne.a.Header,null,"Edit Story"),r.a.createElement(Ne.a.Content,null,r.a.createElement(Rt,{genres:this.props.genres,story:this.state.story,actionText:"Update",onStorySubmit:this.onUpdateStory}))),r.a.createElement(Ne.a,{trigger:r.a.createElement(ne.a,{primary:!0},r.a.createElement(Q.a,{name:"bookmark"}),"Add Chapter"),dimmer:"blurring",closeOnDimmerClick:!1,closeIcon:!0},r.a.createElement(Ne.a.Header,null,"New Chapter"),r.a.createElement(Ne.a.Content,null,r.a.createElement(Pt,{onSubmit:this.submitChapter,chapter:{title:"Chapter ".concat(a.chapters.length+1)},actionText:"Create Chapter"}))),a.closed_group?r.a.createElement(Ne.a,{trigger:r.a.createElement(ne.a,{primary:!0},r.a.createElement(Q.a,{name:"address book"}),"Applicants"),dimmer:"blurring",closeOnDimmerClick:!1,closeIcon:!0},r.a.createElement(Ne.a.Header,null,"Applicants"),r.a.createElement(Ne.a.Content,null,r.a.createElement(Se.a,{className:"character-grid"},a.applicantcharacters.length>0?r.a.createElement(ct.a.Group,{centered:!0},a.applicantcharacters.map(function(t,a){return r.a.createElement(st,{key:a,character:t,actionButtons:r.a.createElement(ne.a.Group,null,r.a.createElement(ne.a,{key:0,icon:!0,color:"blue",onClick:function(a){return e.onAccept(a,t)}},r.a.createElement(Q.a,{name:"check"})),r.a.createElement(ne.a,{key:1,icon:!0,color:"red",onClick:function(a){return e.onDeny(a,t)}},r.a.createElement(Q.a,{name:"close"})))})})):r.a.createElement(ct.a.Group,{centered:!0},r.a.createElement(ct.a,null,r.a.createElement(ct.a.Content,null,r.a.createElement(ct.a.Header,null,r.a.createElement("center",null,"No More Applicants")))))))):null):null,r.a.createElement(Ne.a,{trigger:r.a.createElement(ne.a,{secondary:!0},r.a.createElement(Q.a,{name:"spy"}),"Roster"),dimmer:"blurring",closeOnDimmerClick:!1,closeIcon:!0},r.a.createElement(Ne.a.Header,null,"Character Roster"),r.a.createElement(Ne.a.Content,null,r.a.createElement(Ne.a.Description,null,a.characters?r.a.createElement(it,{characters:a.characters}):r.a.createElement("div",null,"Loading...")))),l&&n?r.a.createElement(Ne.a,{trigger:r.a.createElement(ne.a,{secondary:!0},a.closed_group?r.a.createElement("span",null,r.a.createElement(Q.a,{name:"lock"}),"Apply"):r.a.createElement("span",null,r.a.createElement(Q.a,{name:"lock open"}),"Join")),dimmer:"blurring",closeOnDimmerClick:!1,closeIcon:!0},r.a.createElement(Ne.a.Header,null,a.closed_group?"Apply Character":"Add Character to Roster"),r.a.createElement(Ne.a.Content,null,r.a.createElement(it,{characters:n,onClick:this.onCharacterApplyClick}))):null)))),r.a.createElement(_e.a,{attached:"bottom",className:"linkable"},r.a.createElement(_e.a.Body,null,a.chapters.map(function(t,n){return r.a.createElement(_e.a.Row,{key:n},r.a.createElement(_e.a.Cell,{onClick:function(){e.onChapterClick(a._id,n)}},t.title),r.a.createElement(_e.a.Cell,{onClick:function(){e.onChapterClick(a._id,n)}},t.description),o&&o.user._id===a.author._id?r.a.createElement(_e.a.Cell,{collapsing:!0},r.a.createElement(Ne.a,{trigger:r.a.createElement(ne.a,{secondary:!0,onClick:function(e){return e.stopPropagation()}},"Edit"),closeOnDimmerClick:!1,closeIcon:!0},r.a.createElement(Ne.a.Header,null,"Edit Chapter"),r.a.createElement(Ne.a.Content,null,r.a.createElement(Pt,{chapter:t,onSubmit:e.updateChapter,actionText:"Update Chapter"})))):null)})))):r.a.createElement(L.a,{active:!0}))}}]),t}(n.Component),Bt=Object(W.a)(p.d,q)(Tt),Ut=a(835),Mt={reply:{author:null,description:""},characterList:[],loadedCharacters:!1},Nt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).promises=[],a.onChange=function(e){var t=Object(te.a)({},a.state.reply);t.description=e.target.value,a.setState({reply:t})},a.onSubmit=function(e){console.log(a.state.reply),a.props.onSubmit(a.state.reply)},a.onCharacterApplyClick=function(e){var t=Object(te.a)({},a.state.reply);t.author=e,a.setState({reply:t})},a.state=Object(te.a)({},Mt),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.reply&&this.setState({reply:this.props.reply}),this.promises.splice(this.promises.length-1,0,F(D.a.post("".concat(R).concat("/character/list"),{token:localStorage.getItem("token")}).then(function(t){var a=t.data.characters,n=e.props.story.characters.map(function(e,t){return e._id}),r=a.filter(function(e){var t=e._id;return n.includes(t)});0===a.length?e.setState({characterList:null,loadedCharacters:!0}):e.setState({characterList:r,loadedCharacters:!0})}).catch(function(e){console.log(e)})))}},{key:"render",value:function(){var e=this.state,t=e.characterList,a=e.loadedCharacters,n=e.reply;return r.a.createElement(ae.a,{onSubmit:this.onSubmit},a&&t?[r.a.createElement(it,{key:0,characters:t,onClick:this.onCharacterApplyClick}),r.a.createElement(xe.a,{key:1,placeholder:"Description...",value:this.state.reply.description,onChange:this.onChange}),r.a.createElement(ne.a,{key:2,type:"submit",primary:!0},this.props.actionText),r.a.createElement(_e.a,{key:3},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,n.author?r.a.createElement(_e.a.Cell,null,r.a.createElement("div",{className:"characterPlacard",style:{width:"150px",float:"left",marginRight:"15px"}},r.a.createElement("center",null,r.a.createElement(X.a,null,n.author.name)),r.a.createElement(et.a,{floated:"left",src:n.author.appearance.image,style:{width:"150px"}})),r.a.createElement("pre",{style:{margin:"0"}},n.description)):r.a.createElement(_e.a.Cell,null,r.a.createElement("div",{className:"characterPlacard",style:{width:"150px",float:"left",marginRight:"15px"}},r.a.createElement("center",null,r.a.createElement(X.a,null,"Choose a Character")),r.a.createElement(et.a,{floated:"left",src:null,style:{width:"150px"}})),r.a.createElement("pre",{style:{margin:"0"}},n.description)))))]:r.a.createElement(V.a,null,r.a.createElement($.a,null,r.a.createElement($.a.Header,null,"No characters to reply with!"))))}}]),t}(n.Component),Ft={chapter:null,story:null},Gt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).promises=[],a.onSubmitPost=function(e){e.author&&e.description&&D.a.post("".concat(R).concat(j),{token:localStorage.getItem("token"),post:e,story:a.state.story,chapter:a.state.chapter}).then(function(e){var t=a.props.history.location.pathname;a.props.history.push("/"),a.props.history.push(t)}).catch(function(e){console.log(e)})},a.onUpdatePost=function(e){e.author&&e.description&&D.a.post("".concat(R).concat(S),{token:localStorage.getItem("token"),post:e,story:a.state.story,chapter:a.state.chapter}).then(function(e){var t=a.props.history.location.pathname;a.props.history.push("/"),a.props.history.push(t)}).catch(function(e){console.log(e)})},a.state=Object(te.a)({},Ft),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params,a=t.story_id,n=t.chapter_name;this.promises.splice(this.promises.length,0,F(D.a.get("".concat(R).concat(f.replace(":story_id",a).replace(":chapter_name",n))).then(function(t){e.setState({chapter:t.data.chapter})}).catch(function(e){console.log(e)}))),this.promises.splice(this.promises.length,0,F(D.a.get("".concat(R).concat(g.replace(":story_id",a))).then(function(t){e.setState({story:t.data.story})}).catch(function(e){console.log(e)})))}},{key:"componentWillUnmount",value:function(){this.promises.forEach(function(e){return e.cancel()})}},{key:"render",value:function(){var e=this,t=this.state,a=this.props,n=t.chapter,c=t.story,l=a.userInfo;return r.a.createElement("div",null,n&&c?r.a.createElement(_e.a,{className:"basic-table"},r.a.createElement(_e.a.Body,null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,l?r.a.createElement(Ne.a,{trigger:r.a.createElement(ne.a,{primary:!0},"New Reply"),closeOnDimmerClick:!1,closeIcon:!0},r.a.createElement(Ne.a.Header,null,"New Reply"),r.a.createElement(Ne.a.Content,{scrolling:!0},r.a.createElement(Nt,{story:c,onSubmit:function(t){e.onSubmitPost(t)},actionText:"Submit"}))):null)),n.posts.map(function(t,a){var o=function(t){return r.a.createElement(_e.a.Body,null,l&&l.username===t.author.user.username?r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement(Ne.a,{trigger:r.a.createElement(ne.a,null,"Edit"),closeOnDimmerClick:!1,closeIcon:!0},r.a.createElement(Ne.a.Header,null,"Edit Reply"),r.a.createElement(Ne.a.Content,{scrolling:!0},r.a.createElement(Nt,{story:c,reply:t,onSubmit:e.onUpdatePost,actionText:"Update"}))))):null,r.a.createElement(_e.a.Row,null,r.a.createElement(_e.a.Cell,null,r.a.createElement("div",{className:"characterPlacard",style:{width:"150px",float:"left",marginRight:"15px"}},r.a.createElement("center",null,r.a.createElement(X.a,null,t.author.name)),r.a.createElement(et.a,{floated:"left",src:t.author.appearance.image,style:{width:"150px"}})),r.a.createElement("pre",{style:{margin:"0"}},t.description))))};return r.a.createElement(_e.a.Row,{key:a},r.a.createElement(_e.a.Cell,null,a===n.posts.length-1?r.a.createElement(_e.a,{attached:"bottom"},o(t)):r.a.createElement(_e.a,{attached:!0},o(t))))}))):r.a.createElement(Ut.a,{fluid:!0},r.a.createElement(Ut.a.Header,{image:!0},r.a.createElement(Ut.a.Line,null),r.a.createElement(Ut.a.Line,null)),r.a.createElement(Ut.a.Paragraph,null,r.a.createElement(Ut.a.Line,null),r.a.createElement(Ut.a.Line,null),r.a.createElement(Ut.a.Line,null),r.a.createElement(Ut.a.Line,null))))}}]),t}(n.Component),Wt=Object(W.a)(p.d,q)(Gt),zt={genres:null},qt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).promises=[],a.state=Object(te.a)({},zt),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.promises.splice(this.promises.length-1,0,F(D.a.get("".concat(R).concat("/story/genre/list")).then(function(t){var a={};t.data.genres.forEach(function(e){a[e.name]=!1}),e.setState({genres:t.data.genres})}).catch(function(e){console.log(e)})))}},{key:"render",value:function(){var e=this.state.genres;return r.a.createElement("div",null,e?[r.a.createElement(p.a,{key:0,path:E,component:function(){return r.a.createElement(Dt,{genres:e})}}),r.a.createElement(p.a,{key:1,path:g,component:function(){return r.a.createElement(Bt,{genres:e})}}),r.a.createElement(p.a,{key:2,path:f,component:function(){return r.a.createElement(Wt,null)}})]:r.a.createElement(L.a,{active:!0}))}}]),t}(n.Component),Jt=function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(h.a,null,r.a.createElement(Se.a,null,r.a.createElement(V.a,{inverted:!0,attached:"top",style:{padding:"2px"}},r.a.createElement(K,null)),r.a.createElement(V.a,{attached:"bottom"},r.a.createElement(p.a,{exact:!0,path:"/",component:Z}),r.a.createElement(p.a,{path:"/signup",component:oe}),r.a.createElement(p.a,{path:"/signin",component:Ee}),r.a.createElement(p.a,{path:"/pw-forget",component:ue}),r.a.createElement(p.a,{path:d,component:fe}),r.a.createElement(p.a,{path:"/account",component:ke}),r.a.createElement(p.a,{path:"/admin",component:je}),r.a.createElement(p.a,{path:"/story",component:qt}),r.a.createElement(p.a,{path:"/story/create",component:Te}),r.a.createElement(p.a,{path:k,component:dt}),r.a.createElement(p.a,{path:"/character/list",component:Ze}),r.a.createElement(p.a,{path:w,component:at}),r.a.createElement(p.a,{path:I,component:rt}))))}}]),t}(r.a.Component),Qt=Object(W.a)(G)(Jt);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(T.Provider,{value:new N},r.a.createElement(Qt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[430,1,2]]]);
//# sourceMappingURL=main.5c93be68.chunk.js.map